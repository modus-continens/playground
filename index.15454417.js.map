{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-3aeba786e8629e4f.js","src/page.js","node_modules/@parcel/runtime-js/lib/helpers/get-worker-url.js","node_modules/@parcel/runtime-js/lib/runtime-b1e77636aee8c7a7.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"dyu3l\\\":\\\"index.15454417.js\\\",\\\"g5kKs\\\":\\\"worker.2bc581b1.js\\\"}\"));","let worker = null;\nlet input = document.querySelector('.modusfile-input');\nlet query = document.querySelector('.modus-query');\nlet res = document.querySelector('.result');\nlet progress_bar = document.querySelector('.progress-bar');\nlet last_query_id = 0;\nlet last_query_completed = true;\n\nfunction init_worker() {\n  if (worker !== null) {\n    worker.terminate();\n  }\n  worker = new Worker(new URL('worker.js', import.meta.url), { type: 'module' });\n  worker.onmessage = function ({ data }) {\n    if (data.query_id != last_query_id) {\n      return;\n    }\n    res.innerHTML = \"\";\n    for (let block of data.res.spans) {\n      let node = document.createElement(\"span\");\n      node.textContent = block.text;\n      node.setAttribute(\"style\", block.css);\n      res.appendChild(node);\n    }\n    res.classList.remove(\"loading\");\n    progress_bar.style.visibility = \"hidden\";\n    last_query_completed = true;\n  }\n}\n\ninit_worker();\n\nfunction update() {\n  if (!last_query_completed) {\n    init_worker();\n  }\n  last_query_id += 1;\n  res.classList.add(\"loading\");\n  progress_bar.style.visibility = \"\";\n  worker.postMessage({\n    query: query.value,\n    modusfile: input.value,\n    query_id: last_query_id\n  });\n  last_query_completed = false;\n}\n\ninput.addEventListener('input', update);\nquery.addEventListener('input', update);\nupdate();\n\nlet left_area = document.querySelector(\".input-area\");\nlet divider = document.querySelector(\".divider\");\n\nlet desktop_mode = window.innerWidth >= 1000;\n\ndivider.addEventListener(\"mousedown\", function (evt) {\n  if (!desktop_mode) {\n    return;\n  }\n  evt.preventDefault();\n  let down_w = parseFloat(window.getComputedStyle(left_area).width);\n  let offset = down_w - evt.clientX;\n  function up_handler(evt) {\n    evt.preventDefault();\n    window.removeEventListener(\"mouseup\", up_handler);\n    window.removeEventListener(\"mousemove\", move_handler);\n  }\n  function move_handler(evt) {\n    evt.preventDefault();\n    let new_w = evt.clientX + offset;\n    left_area.style.width = Math.max(100, Math.min(new_w, window.innerWidth - 100)) + \"px\";\n    left_area.style.flexBasis = \"auto\";\n    left_area.style.flexShrink = \"0\";\n    left_area.style.flexGrow = \"0\";\n  }\n  window.addEventListener(\"mouseup\", up_handler);\n  window.addEventListener(\"mousemove\", move_handler);\n});\n\nwindow.addEventListener(\"resize\", function () {\n  if (desktop_mode && window.innerWidth < 1000) {\n    desktop_mode = false;\n    left_area.style.width = \"\";\n    left_area.style.flexBasis = \"\";\n    left_area.style.flexShrink = \"\";\n    left_area.style.flexGrow = \"\";\n  } else if (!desktop_mode && window.innerWidth >= 1000) {\n    desktop_mode = true;\n  }\n});\n\nlet share_btn = document.querySelector(\".share-btn\");\nlet share_msg = document.querySelector(\".share-msg\");\nshare_btn.addEventListener(\"click\", function () {\n  let q = query.value;\n  let m = input.value;\n  window.location.hash = \"#\" + encodeURIComponent(JSON.stringify({ q, m }));\n  share_msg.innerHTML = \"Link generated. Copy from address bar!\";\n});\n\nlet current_hash = window.location.hash;\nif (current_hash.startsWith(\"#\")) {\n  let json = JSON.parse(decodeURIComponent(current_hash.substring(1)));\n  query.value = json.q;\n  input.value = json.m;\n  update();\n  window.location.hash = \"\";\n}\n","\"use strict\";\n\nmodule.exports = function (workerUrl, origin, isESM) {\n  if (origin === self.location.origin) {\n    // If the worker bundle's url is on the same origin as the document,\n    // use the worker bundle's own url.\n    return workerUrl;\n  } else {\n    // Otherwise, create a blob URL which loads the worker bundle with `importScripts`.\n    var source = isESM ? 'import ' + JSON.stringify(workerUrl) + ';' : 'importScripts(' + JSON.stringify(workerUrl) + ');';\n    return URL.createObjectURL(new Blob([source], {\n      type: 'application/javascript'\n    }));\n  }\n};","let workerURL = require('./helpers/get-worker-url');\nlet url = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"g5kKs\"));\nmodule.exports = workerURL(url.toString(), url.origin, true);"],"names":["$18c11f3350a906ea$export$6503ec6e8aabbaf","$18c11f3350a906ea$export$f7ad0328861e2f03","$18c11f3350a906ea$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$eac2b31c5711b350$var$worker","$eac2b31c5711b350$var$input","document","querySelector","$eac2b31c5711b350$var$query","$eac2b31c5711b350$var$res","$eac2b31c5711b350$var$progress_bar","$eac2b31c5711b350$var$last_query_id","$eac2b31c5711b350$var$last_query_completed","$56b621a6dd25b2cb$exports","workerUrl","origin","isESM","self","location","source","stringify","URL","createObjectURL","Blob","type","$dde6d2ad56f1d070$var$url","resolve","import","meta","url","$eac2b31c5711b350$var$init_worker","terminate","Worker","$dde6d2ad56f1d070$exports","onmessage","data","query_id","innerHTML","block","res","spans","node","createElement","textContent","text","setAttribute","css","appendChild","classList","remove","style","visibility","$eac2b31c5711b350$var$update","add","postMessage","query","value","modusfile","toString","addEventListener","$eac2b31c5711b350$var$left_area","$eac2b31c5711b350$var$divider","$eac2b31c5711b350$var$desktop_mode","window","innerWidth","evt1","preventDefault","offset","parseFloat","getComputedStyle","width","clientX","move_handler","evt","new_w","Math","max","min","flexBasis","flexShrink","flexGrow","up_handler","removeEventListener","$eac2b31c5711b350$var$share_btn","$eac2b31c5711b350$var$share_msg","q","m","hash","encodeURIComponent","$eac2b31c5711b350$var$current_hash","startsWith","json","decodeURIComponent","substring"],"version":3,"file":"index.15454417.js.map"}